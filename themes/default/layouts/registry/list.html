{{ define "main" }}
    <div class="container mx-auto px-4 pt-8 mt-2 mb-12">
        {{ if and (.Params.h1) (not .Params.notitle) }}
            <h1>{{ .Params.h1 }}</h1>
        {{ else if and (ne .Title "") (not .Params.notitle) }}
            <h1>{{ .Title }}</h1>
        {{ end }}

        <h1>Pulumi Packages</h1>
        <p>
            Discover packages that give you direct access to all resources and components.</br>
            You can <a href="https://github.com/pulumi/registry" class="underline">contribute your own packages</a>, too!
        </p>
    </div>

    {{ $allGetStarted := $.Site.Data.registry.getstarted }}
    {{ $allPackages := $.Site.Data.registry.packages }}

    {{ $featuredPackages := slice }}
    {{ range $allPackages }}
        {{ if .featured }}
            {{ $featuredPackages = $featuredPackages | append . }}
        {{ end }}
    {{ end }}

    <div class="packages container mx-auto pb-16 z-0">
        <section class="featured-packages my-8">
            <h2 class="px-4 inline-flex items-center">
                Featured Packages
            </h2>
            <div class="flex flex-wrap">
                {{ range $featuredPackages }}
                    {{ partial "registry/featured-package" (dict "package" .) }}
                {{ end }}
            </div>
        </section>

        <section class="all-packages my-8">
            <div class="mt-12 mb-2 px-4 relative z-10">
                <h4 class="text-lg">Filters</h4>
                <div class="flex flex-col md:flex-row md:items-start">
                    <pulumi-filter-select>

                        <!-- Package-type options -->
                        <pulumi-filter-select-option-group name="type">
                            <div class="toggle" slot="toggle">Type</div>
                            <div class="options">
                                <pulumi-filter-select-option value="native-provider" label="Native Provider">Native Provider</pulumi-option>
                                <pulumi-filter-select-option value="provider" label="Provider">Provider</pulumi-option>
                                <pulumi-filter-select-option value="component" label="Component">Component</pulumi-option>
                            </div>
                        </pulumi-filter-select-option-group>

                        <!-- Use-case options -->
                        <pulumi-filter-select-option-group name="category" class="mx-1 md:mx-4">
                            <div class="toggle" slot="toggle">Use Case</div>
                            <div class="options">
                                <pulumi-filter-select-option value="cloud" label="Cloud">Cloud</pulumi-option>
                                <pulumi-filter-select-option value="database" label="Database">Database</pulumi-option>
                                <pulumi-filter-select-option value="infrastructure" label="Infrastructure">Infrastructure</pulumi-option>
                                <pulumi-filter-select-option value="monitoring" label="Monitoring">Monitoring</pulumi-option>
                                <pulumi-filter-select-option value="network" label="Network">Network</pulumi-option>
                                <pulumi-filter-select-option value="utility" label="Utility">Utility</pulumi-option>
                                <pulumi-filter-select-option value="version control system" label="Version Control">Version Control</pulumi-option>
                            </div>
                        </pulumi-filter-select-option-group>

                    </pulumi-filter-select>

                    <!-- The list of active filters. -->
                    <ul class="package-tags active-tags"></ul>

                    <!-- The template used for displaying active filters. -->
                    <template id="active-tag-template">
                        <li>
                            <span></span>
                            <button class="ml-2 text-base hover:text-gray-900" title="Clear filter">&times;</a>
                        </li>
                    </template>
                </div>
            </div>

            <h2 class="px-4 inline-flex items-center">
                A-Z Packages
                <span class="all-count ml-4 py-0.5 px-3 rounded-full bg-violet-600 text-white text-lg">
                    {{ len $allPackages }}
                </span>
            </h2>
            <div class="flex flex-wrap">
                {{ range $allPackages }}
                    {{ partial "registry/package" (dict "package" .) }}
                {{ end }}
                <div class="no-results px-4">
                    <p>
                        Looks like we don't have any packages that match your filters.
                        Adjust or clear the filters and try again.
                    </p>
                    <button class="reset btn btn-lg">Clear all filters</button>
                </div>
            </div>
        </section>
    </div>
{{ end }}
