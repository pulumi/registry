import{r as t,h as s,g as i}from"./p-68998d96.js";import{g as o,p as n,b as e}from"./p-3a06a8a9.js";const r=class{constructor(s){t(this,s),this.isLoading=!0,this.didLoad=!1}componentWillLoad(){if(!this.formId)throw new Error("The required attribute `form-id` was not provided.");this.hubspotFormTargetId=`hubspotForm_${this.formId}`}componentDidLoad(){const t=window.hbspt;t?this.createForm(t):this.loadHubSpotFormsScript(),this.messageHandler=this.onMessage.bind(this),window.addEventListener("message",this.messageHandler)}disconnectedCallback(){window.removeEventListener("message",this.messageHandler)}onMessage(t){var s;if("hsFormCallback"!==(null===(s=t.data)||void 0===s?void 0:s.type))return;const i=t.data.eventName,o=this.getUTMCookieData();if("onFormReady"===i){this.isLoading=!1,this.didLoad=!0,this.el.querySelectorAll('input[type="hidden"]').forEach((t=>{const s=t.closest("fieldset");s&&(s.style.display="none")}));const t=this.el.querySelector('input[name="last_utm_campaign"]');t&&(t.value=o.campaign);const s=this.el.querySelector('input[name="last_utm_source"]');s&&(s.value=o.source);const i=this.el.querySelector('input[name="last_utm_medium"]');i&&(i.value=o.medium),this.setInternalAdId()}if("onFormSubmit"===i){const t=this.el.querySelector('input[name="email"]');this.notifySegment(t.value,o)}"onFormDefinitionFetchError"===i&&(this.isLoading=!1,this.didLoad=!1)}notifySegment(t,s){const i=window.analytics;i&&i.track&&"function"==typeof i.track&&""!==t&&i.track("form-submission",{formId:this.formId,email:t,utmCampaign:s.campaign,utmSource:s.source,utmMedium:s.medium})}setInternalAdId(){const t=o("iaid");if(t){const s=this.el.querySelector('input[name="last_internal_ad_conversion"]');s&&(s.value=t)}}getUTMCookieData(){const t=n(),s=e(t.__utmzz);return{campaign:s.utmccn||"(not set)",source:s.utmcsr||"(direct)",medium:s.utmcmd||"(none)"}}loadHubSpotFormsScript(){const t=document.createElement("script");t.setAttribute("src","//js.hsforms.net/forms/v2.js"),t.onload=()=>{const t=window.hbspt;t?this.createForm(t):(this.isLoading=!1,this.didLoad=!1)},t.onerror=()=>{this.isLoading=!1,this.didLoad=!1},document.body.appendChild(t)}createForm(t){t.forms.create({portalId:"4429525",formId:this.formId,css:"",cssClass:this.class,goToWebinarWebinarKey:this.goToWebinarKey,target:`#${this.hubspotFormTargetId}`,sfdcCampaignId:this.salesforceCampaignId})}renderIsLoadingForm(){return s("p",null,s("i",{class:"fa fa-spinner fa-spin mr-2"}))}renderFailedToLoadForm(){return s("p",null,"There was an problem loading this form. Please try refreshing your browser, and if you continue to see this message, let us know at"," ",s("a",{href:"mailto:support@pulumi.com"},"support@pulumi.com"),".")}render(){return s("div",{id:this.hubspotFormTargetId},this.didLoad||this.isLoading?this.renderIsLoadingForm():this.renderFailedToLoadForm())}get el(){return i(this)}};r.style=":host{display:block}";export{r as pulumi_hubspot_form}